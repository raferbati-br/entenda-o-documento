# C2 - Containers

## Containers
- Web App (Next.js App Router)
- API Routes (Next.js, Node runtime)
- OpenAI Responses API
- Redis (Upstash) for capture storage, rate limiting, and aggregated counters
- PostHog (optional) for telemetry events
- Client Storage (IndexedDB + sessionStorage)

## Diagram
```mermaid
flowchart TB
  subgraph Browser
    UI[Next.js UI]
    Storage[(IndexedDB / sessionStorage)]
  end

  subgraph Server
    API[Next.js API Routes]
    Memory[(In-memory store - dev fallback)]
    Redis[(Redis / Upstash)]
  end

  PostHog[(PostHog - optional)]

  UI -->|image data| API
  API --> Redis
  API --> Memory
  API -->|image + prompt| OpenAI[(OpenAI Responses API)]
  API -->|result| UI
  UI --> Storage
  UI -->|telemetry events| PostHog
```
