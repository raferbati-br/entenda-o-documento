# C3 - Components

## Server Components (API Routes)
- /api/session-token: issues short-lived session token
- /api/capture: validates and stores image data (short TTL)
- /api/analyze: loads image data and calls AI pipeline
- /api/health: simple health check

## AI Pipeline Components
- Prompt registry (src/ai/prompts)
- Provider adapter (src/ai/providers)
- Postprocess and safety softening (src/ai/postprocess.ts)

## Diagram
```mermaid
flowchart LR
  Capture[/api/capture/] --> Store[(Capture Store)]
  Analyze[/api/analyze/] --> Store
  Analyze --> AnalyzeDoc[analyzeDocument]
  AnalyzeDoc --> Prompt[getPrompt]
  AnalyzeDoc --> Provider[getProvider -> OpenAI]
  AnalyzeDoc --> Postprocess[postprocess]
```
